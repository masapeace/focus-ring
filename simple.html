<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus Ring - Simple Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f0f0f0; }
        .time-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 20px 0; }
        .time-slot { 
            border: 3px solid #333; 
            padding: 20px; 
            min-height: 80px; 
            cursor: pointer; 
            text-align: center; 
            background: white;
            border-radius: 10px;
            font-size: 14px;
            font-weight: bold;
        }
        .time-slot:hover { background-color: #e0e0e0; }
        .filled { color: white; }
        .modal { 
            display: none; 
            position: fixed; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            background: white; 
            border: 5px solid #333; 
            padding: 40px; 
            z-index: 1000;
            border-radius: 15px;
        }
        .category-btn { 
            margin: 10px; 
            padding: 20px 25px; 
            border: none; 
            border-radius: 10px; 
            cursor: pointer; 
            color: white; 
            font-weight: bold;
            font-size: 16px;
        }
        .debug { background: #ffffcc; padding: 15px; margin: 15px 0; border: 2px solid #ffcc00; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ¯ Focus Ring - Simple Test</h1>
    
    <div class="debug" id="debug-info">
        <strong>ãƒ‡ãƒãƒƒã‚°æƒ…å ±:</strong><br>
        <div id="debug-log">ã‚¢ãƒ—ãƒªã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>

    <h2>ğŸ“… ã‚¿ã‚¤ãƒ ã‚°ãƒªãƒƒãƒ‰ (ç°¡æ˜“ç‰ˆ)</h2>
    <div class="time-grid" id="time-grid"></div>

    <!-- ã‚«ãƒ†ã‚´ãƒªé¸æŠãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="category-modal" class="modal">
        <h3>â° <span id="modal-time">04:00</span> ã®ã‚«ãƒ†ã‚´ãƒªé¸æŠ</h3>
        <button onclick="closeCategoryModal()" style="float: right; font-size: 20px;">Ã—</button>
        <br><br>
        <div id="all-categories"></div>
    </div>

    <script>
        const CATEGORIES = [
            { code: "STUDY", label: "ğŸ“š å‹‰å¼·", color: "#4CAF50" },
            { code: "WORK", label: "ğŸ’¼ ä½œæ¥­", color: "#FF9800" },
            { code: "REST", label: "ğŸ˜´ ä¼‘æ†©", color: "#CDDC39" },
            { code: "VIDEO", label: "ğŸ“º å‹•ç”»", color: "#E91E63" }
        ];

        let selectedSlot = null;
        let slotData = {}; // ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ãƒ¼ã‚¿ä¿å­˜

        function debug(message) {
            console.log('ğŸ” SIMPLE DEBUG:', message);
            const debugLog = document.getElementById('debug-log');
            const timestamp = new Date().toLocaleTimeString();
            debugLog.innerHTML += `<br>${timestamp}: ${message}`;
        }

        function formatTime(slotIndex) {
            const hours = 4 + Math.floor(slotIndex / 4);
            const minutes = (slotIndex % 4) * 15;
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        }

        function generateTimeGrid() {
            debug('ã‚°ãƒªãƒƒãƒ‰ç”Ÿæˆé–‹å§‹');
            const grid = document.getElementById('time-grid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 8; i++) { // 8å€‹ã®ã‚¹ãƒ­ãƒƒãƒˆï¼ˆ04:00-05:45ï¼‰
                const slot = document.createElement('div');
                slot.className = 'time-slot';
                slot.id = `slot-${i}`;
                slot.innerHTML = `<div>${formatTime(i)}</div><div id="content-${i}"></div>`;
                slot.onclick = () => openCategoryModal(i);
                grid.appendChild(slot);
            }
            debug('ã‚°ãƒªãƒƒãƒ‰ç”Ÿæˆå®Œäº†: 8å€‹ã®ã‚¹ãƒ­ãƒƒãƒˆä½œæˆ');
        }

        function openCategoryModal(slotIndex) {
            debug(`ãƒ¢ãƒ¼ãƒ€ãƒ«é–‹ã: ã‚¹ãƒ­ãƒƒãƒˆ${slotIndex} (${formatTime(slotIndex)})`);
            selectedSlot = slotIndex;
            
            document.getElementById('modal-time').textContent = formatTime(slotIndex);
            
            const container = document.getElementById('all-categories');
            container.innerHTML = '';
            
            CATEGORIES.forEach((cat, index) => {
                const btn = document.createElement('button');
                btn.className = 'category-btn';
                btn.textContent = cat.label;
                btn.style.backgroundColor = cat.color;
                btn.onclick = () => {
                    debug(`ã‚«ãƒ†ã‚´ãƒªãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯: ${cat.label} (${cat.code})`);
                    selectCategory(cat.code);
                };
                container.appendChild(btn);
                debug(`ã‚«ãƒ†ã‚´ãƒªãƒœã‚¿ãƒ³${index + 1}ä½œæˆ: ${cat.label}`);
            });
            
            document.getElementById('category-modal').style.display = 'block';
            debug('ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºå®Œäº†');
        }

        function selectCategory(code) {
            debug(`ã‚«ãƒ†ã‚´ãƒªé¸æŠé–‹å§‹: ${code} for slot ${selectedSlot}`);
            
            if (selectedSlot === null) {
                debug('âŒ ã‚¨ãƒ©ãƒ¼: selectedSlot ãŒ null');
                return;
            }
            
            // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
            slotData[selectedSlot] = code;
            debug(`ãƒ‡ãƒ¼ã‚¿ä¿å­˜: slot${selectedSlot} = ${code}`);
            
            // è¡¨ç¤ºæ›´æ–°
            updateSlotDisplay(selectedSlot, code);
            
            // ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹
            closeCategoryModal();
            debug('âœ… ã‚«ãƒ†ã‚´ãƒªé¸æŠå®Œäº†');
        }

        function updateSlotDisplay(slotIndex, categoryCode) {
            debug(`è¡¨ç¤ºæ›´æ–°é–‹å§‹: slot${slotIndex}, category${categoryCode}`);
            
            const slot = document.getElementById(`slot-${slotIndex}`);
            const content = document.getElementById(`content-${slotIndex}`);
            const category = CATEGORIES.find(cat => cat.code === categoryCode);
            
            if (slot && content && category) {
                slot.style.backgroundColor = category.color;
                slot.classList.add('filled');
                content.textContent = category.label;
                debug(`âœ… è¡¨ç¤ºæ›´æ–°æˆåŠŸ: ${category.label}`);
            } else {
                debug(`âŒ è¡¨ç¤ºæ›´æ–°å¤±æ•—: slot=${!!slot}, content=${!!content}, category=${!!category}`);
            }
        }

        window.closeCategoryModal = function() {
            debug('ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹');
            document.getElementById('category-modal').style.display = 'none';
            selectedSlot = null;
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            debug('ã‚¢ãƒ—ãƒªåˆæœŸåŒ–é–‹å§‹');
            generateTimeGrid();
            debug('ã‚¢ãƒ—ãƒªåˆæœŸåŒ–å®Œäº† - ãƒ†ã‚¹ãƒˆæº–å‚™OK!');
        });
    </script>
</body>
</html>